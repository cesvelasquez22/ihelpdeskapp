<app-loading-overlay [isActive]="loading"></app-loading-overlay>
<div class="w-full">
    <app-title-header [titleHeader]="titleHeader"></app-title-header>
    <div class="flex flex-col flex-auto min-w-0">

        <!-- Main -->
        <div class="flex flex-col flex-auto items-center p-6 sm:p-10">
            <div class="flex flex-col w-full max-w-4xl">
                <div class="mt-2 text-4xl sm:text-7xl font-extrabold tracking-tight leading-tight">
                    Nuevo ticket
                </div>
                <!-- Form -->
                <div class="mt-8 sm:mt-12 p-6 pb-7 sm:p-10 sm:pb-7 shadow rounded-2xl bg-white">
                    <form class="space-y-3" [formGroup]="form" #supportNgForm="ngForm">
                        <div class="mb-6">
                            <div class="text-2xl font-bold tracking-tight">Envíanos tu solicitud</div>
                            <div class="text-secondary">Tu solicitud sera atentida por un oficial, supervisor o auxiliar
                                del departamento a la brevedad posible.</div>
                        </div>
                        <!-- Subject -->
                        <mat-form-field class="w-full">
                            <input matInput [formControlName]="'subject'" [required]="true">
                            <mat-label>Asunto del ticket</mat-label>
                            <mat-error *ngIf="form.get('subject').hasError('required')">
                                El campo es requerido
                            </mat-error>
                        </mat-form-field>
                        <!-- Category -->
                        <mat-form-field class="w-full">
                            <mat-label>Categoría del ticket</mat-label>
                            <mat-select formControlName="category" [required]="true">
                                <mat-option value="">--Seleccione--</mat-option>
                                <mat-option *ngFor="let category of categories" [value]="category">{{ category.name }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="form.get('category').hasError('required')">
                                El campo es requerido
                            </mat-error>
                        </mat-form-field>
                        <!-- Department -->
                        <mat-form-field class="w-full">
                            <mat-label>Departamento solicitado</mat-label>
                            <mat-select formControlName="department" [required]="true">
                                <mat-option value="">--Seleccione--</mat-option>
                                <mat-option *ngFor="let dept of departments" [value]="dept">{{ dept.name }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="form.get('department').hasError('required')">
                                El campo es requerido
                            </mat-error>
                        </mat-form-field>
                        <!-- Priority -->
                        <mat-form-field class="w-full">
                            <mat-label>Prioridad</mat-label>
                            <mat-select formControlName="priority" [required]="true">
                                <mat-option value="">--Seleccione--</mat-option>
                                <mat-option *ngFor="let priority of priorities" [value]="priority">{{ priority.name }}</mat-option>
                            </mat-select>
                            <mat-error *ngIf="form.get('priority').hasError('required')">
                                El campo es requerido
                            </mat-error>
                        </mat-form-field>
                        <!-- Description -->
                        <mat-form-field class="fuse-mat-textarea w-full">
                            <mat-label>Descripción del ticket</mat-label>
                            <textarea matInput [cdkTextareaAutosize] [cdkAutosizeMinRows]="5" [cdkAutosizeMaxRows]="5"
                                [formControlName]="'description'" [required]="true"></textarea>
                            <mat-error *ngIf="form.get('description').hasError('required')">
                                El campo es requerido
                            </mat-error>
                        </mat-form-field>
                        <!-- Actions -->
                        <div class="flex items-center justify-end">
                            <button mat-button [color]="'accent'" [disabled]="form.pristine || form.untouched"
                                (click)="$event.preventDefault()" [routerLink]="'..'">
                                Cancelar
                            </button>
                            <button class="ml-2" mat-flat-button [color]="'primary'"
                                [disabled]="form.pristine || form.invalid" (click)="$event.preventDefault(); onSubmit()">
                                Enviar
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>